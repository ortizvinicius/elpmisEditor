!function(e,t){"use strict";function n(e,t,n){t.forEach(function(t){e.addEventListener(t,n)})}var i=[],o={autoInit:!0,silentMode:!1,previewMode:!0,keyListen:!0,types:["basic","header","blocks","lists","special","colors","hyperlink"],basic:["strong","em","mark","sup","sub","del","br"],header:["h1","h2","h3","h4","h5","h6"],blocks:["p","blockquote","pre"],lists:["ul","ol","dl"],special:["abbr","code","hr"],colors:"class",hyperlink:!0},s=function(){var e=1;return function(t,n){"object"==typeof t&&null!==t&&(this.name=t.name||"customComponent"+e,this.element=t.element||"span",this.class=t.class||"customClass"+e,this.type=n.indexOf(t.type)>-1?t.type:"special",e++)}}(),r=function(){function e(e,n){var i=t[e];return n&&n.forEach(function(e,t){i=i.split("{{"+t+"}}").join(e)}),i}var t=["The element {{0}} is already been used. Use the destroy method before set it again.","Cannot add a customComponent to an element already started, set the autoInit option to false, add the customComponent then use init() or initAll(). You can look at the status property to check if the element was already started."];return function(t,n){this.name="ElpmisError",this.code=t,this.message=e(t,n),this.logError=function(){console.error(this.name+":",this.code,this.message)}}}(),l=function(e){var i=t.createElement("div"),o=this;i.classList.add("elpmisPreviewElement"),i.classList.add("active"),i.id="elpmisPreviewElement"+e.elpmisId,this.updatePreview=function(){i.innerHTML=e.value},this.addToDOM=function(){t.body.insertBefore(i,e)},this.watch=function(){n(e,["input","change","keyup","keydown","keypress"],function(){o.updatePreview()})},this.updatePreview()},a=function(e,n){function a(e){if(v){if(!b.silentMode)throw new r(1);new r(1).logError()}else{e="object"==typeof e?e:{};var t=new s(e,b.types);t&&k.push(t)}}function c(e){e.addEventListener("keypress",function(t){var n=t.which||t.keyCode,i=t.shiftKey;b.blocks.indexOf("p")>-1&&(13!==n||i||(t.preventDefault(),f(e,{element:"p",newLineBefore:!0,inline:!1}))),b.basic.indexOf("br")>-1&&13===n&&i&&(t.preventDefault(),f(e,{element:"br",newLineAfter:!0,close:!1}))})}function f(e,t){if(e){t="object"==typeof t?t:{},t.element=t.element||"p",t.newLineBefore=!!t.hasOwnProperty("newLineBefore")&&t.newLineBefore,t.newLineAfter=!!t.hasOwnProperty("newLineAfter")&&t.newLineAfter,t.close=!t.hasOwnProperty("close")||t.close,t.inline=!t.hasOwnProperty("inline")||t.inline;var n=e.selectionStart,i=e.selectionEnd,o=0,s=e.value,r="";t.inline?(r=s.substring(0,n),r+=t.newLineBefore?"\n":"",r+="<"+t.element+">",r+=s.substring(n,i),t.newLineBefore&&(o=r.length),r+=t.close?"</"+t.element+">":"",r+=t.newLineAfter?"\n":"",t.newLineAfter&&(o=r.length),r+=s.substring(i)):(r=s,r+=t.newLineBefore?"\n":"",r+="<"+t.element+">",t.newLineBefore&&(o=r.length),r+=t.close?"</"+t.element+">":"",r+=t.newLineAfter?"\n":"",t.newLineAfter&&(o=r.length)),e.value=r,e.selectionStart=e.selectionEnd=o}}function u(e){var t=e.elpmisId;g[t]=new l(e),g[t].addToDOM(),g[t].watch()}function h(e){v||(v=!0),b.keyListen&&c(e),b.previewMode&&u(e)}function d(){E.forEach(h)}function p(){i[m]=!1;var e=Object.keys(this);e.forEach(function(e){delete this[e]},this)}"object"==typeof e&&(n=e,e=!1);var m=e||".elpmis",w=m.substr(0,1),y=m.substr(1),b={},v=!1,E=[],L=!1,k=[],g=[];if("object"==typeof n&&null!==n?Object.keys(o).forEach(function(e){n.hasOwnProperty(e)?b[e]=n[e]:b[e]=o[e]}):b=o,!i[m]){switch(i[m]=!0,w){case"#":E[0]=t.getElementById(y);break;case".":L=t.getElementsByClassName(y);break;default:L=t.getElementsByTagName(m)}return L&&Array.prototype.forEach.call(L,function(e){E.push(e)}),E.forEach(function(e,t){e.elpmisId=t}),b.autoInit&&d(),{status:v,selector:m,options:b,elements:E,customComponents:k,previewElements:g,destroy:p,addCustomComponent:a,init:h,initAll:d,addHTMLElement:f}}if(!b.silentMode)throw new r(0,[m]);new r(0,[m]).logError()};e.ElpmisEditor=a}(window,document);