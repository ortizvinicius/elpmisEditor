!function(e,n){"use strict";function t(e,n,t){n.forEach(function(n){e.addEventListener(n,t)})}var i=[],s={autoInit:!0,silentMode:!1,previewMode:!0,keyListen:!0,types:["basic","header","blocks","lists","special","colors","hyperlink"],basic:["strong","em","mark","sup","sub","del","br"],header:["h1","h2","h3","h4","h5","h6"],blocks:["p","blockquote","pre"],lists:["ul","ol","dl"],special:["abbr","code","hr"],colors:"class",hyperlink:!0},o=function(){var e=1;return function(n,t){"object"==typeof n&&null!==n&&(this.name=n.name||"customComponent"+e,this.element=n.element||"span",this.class=n.class||"customClass"+e,this.type=t.indexOf(n.type)>-1?n.type:"special",e++)}}(),r=function(){function e(e,t){var i=n[e];return t&&t.forEach(function(e,n){i=i.split("{{"+n+"}}").join(e)}),i}var n=["The element {{0}} is already been used. Use the destroy method before set it again.","Cannot add a customComponent to an element already started, set the autoInit option to false, add the customComponent then use init() or initAll(). You can look at the status property to check if the element was already started."];return function(n,t){this.name="ElpmisError",this.code=n,this.message=e(n,t),this.logError=function(){console.error(this.name+":",this.code,this.message)}}}(),l=function(e){var i=n.createElement("div"),s=this;i.classList.add("elpmisPreviewElement"),i.classList.add("active"),i.id="elpmisPreviewElement"+e.elpmisId,this.updatePreview=function(){i.innerHTML=e.value},this.addToDOM=function(){n.body.insertBefore(i,e)},this.watch=function(){t(e,["input","change","keyup","keydown","keypress"],function(){s.updatePreview()})},this.updatePreview()},a=function(e,t){function a(e){if(v){if(!b.silentMode)throw new r(1);new r(1).logError()}else{e="object"==typeof e?e:{};var n=new o(e,b.types);n&&g.push(n)}}function c(e){e.addEventListener("keypress",function(n){var t=n.which||n.keyCode,i=n.shiftKey;b.blocks.indexOf("p")>-1&&(13!==t||i||(n.preventDefault(),u(e,{element:"p",newLineBefore:!0,newLineAfter:!0,inline:!1}))),b.basic.indexOf("br")>-1&&13===t&&i&&(n.preventDefault(),u(e,{element:"br",newLineAfter:!0,close:!1}))})}function u(e,n){if(e){n="object"==typeof n?n:{},n.element=n.element||"p",n.newLineBefore=!!n.hasOwnProperty("newLineBefore")&&n.newLineBefore,n.newLineAfter=!!n.hasOwnProperty("newLineAfter")&&n.newLineAfter,n.close=!n.hasOwnProperty("close")||n.close,n.inline=!n.hasOwnProperty("inline")||n.inline;var t,i,s,o=e.selectionStart,r=e.selectionEnd,l="",a=0,c=e.value,u="",f=!1,h=/<*>/i;o!==r&&(l=c.substring(o,r),f=h.test(l)),i=c.substring(0,o).split("\n"),s=c.substring(r).split("\n"),t=i[i.length-1]+l+s[0],f||(f=h.test(t)),n.inline||""!==l&&!f?(u=c.substring(0,o),u+=n.inline&&n.newLineBefore?"\n":"",u+="<"+n.element+">",u+=c.substring(o,r),n.newLineBefore&&(a=u.length),u+=n.close?"</"+n.element+">":"",u+=n.inline&&n.newLineAfter?"\n":"",n.newLineAfter&&(a=u.length),u+=c.substring(r)):(i.pop(),s.shift(),u=i.join("\n"),u+=n.newLineBefore?"\n":"",u+=t,u+=n.newLineBefore?"\n":"",u+="<"+n.element+">",a=u.length,u+=n.close?"</"+n.element+">":"",u+=n.newLineAfter?"\n":"",u+=s.join("\n")),e.value=u,e.selectionStart=e.selectionEnd=a}}function f(e){var n=e.elpmisId;k[n]=new l(e),k[n].addToDOM(),k[n].watch()}function h(e){v||(v=!0),b.keyListen&&c(e),b.previewMode&&f(e)}function p(){E.forEach(h)}function d(){i[m]=!1;var e=Object.keys(this);e.forEach(function(e){delete this[e]},this)}"object"==typeof e&&(t=e,e=!1);var m=e||".elpmis",w=m.substr(0,1),y=m.substr(1),b={},v=!1,E=[],L=!1,g=[],k=[];if("object"==typeof t&&null!==t?Object.keys(s).forEach(function(e){t.hasOwnProperty(e)?b[e]=t[e]:b[e]=s[e]}):b=s,!i[m]){switch(i[m]=!0,w){case"#":E[0]=n.getElementById(y);break;case".":L=n.getElementsByClassName(y);break;default:L=n.getElementsByTagName(m)}return L&&Array.prototype.forEach.call(L,function(e){E.push(e)}),E.forEach(function(e,n){e.elpmisId=n}),b.autoInit&&p(),{status:v,selector:m,options:b,elements:E,customComponents:g,previewElements:k,destroy:d,addCustomComponent:a,init:h,initAll:p,addHTMLElement:u}}if(!b.silentMode)throw new r(0,[m]);new r(0,[m]).logError()};e.ElpmisEditor=a}(window,document);